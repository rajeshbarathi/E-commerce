import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelReader {

    public static LinkedHashMap<String, List<String>> readExcel(String filePath, String sheetName) {
        LinkedHashMap<String, List<String>> excelData = new LinkedHashMap<>();

        try (FileInputStream file = new FileInputStream(new File(filePath));
             Workbook workbook = new XSSFWorkbook(file)) {

            Sheet sheet = workbook.getSheet(sheetName);
            Row headerRow = sheet.getRow(0);

            for (int rowIdx = 3; rowIdx <= sheet.getLastRowNum(); rowIdx++) {
                Row currentRow = sheet.getRow(rowIdx);
                List<String> values = new ArrayList<>();

                for (int colIdx = 0; colIdx < headerRow.getLastCellNum(); colIdx++) {
                    Cell currentCell = currentRow.getCell(colIdx, Row.MissingCellPolicy.CREATE_NULL_AS_BLANK);
                    String columnHeader = headerRow.getCell(colIdx).getStringCellValue();
                    String cellValue = currentCell.getStringCellValue(); // Adjust as needed

                    values.add(cellValue);
                }

                excelData.put(headerRow.getCell(3).getStringCellValue(), values);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }

        return excelData;
    }

    public static void main(String[] args) {
        String filePath = "path/to/your/excel.xlsx";
        String sheetName = "yourSheetName";
        LinkedHashMap<String, List<String>> excelData = readExcel(filePath, sheetName);

        // Access the data as needed
        for (String key : excelData.keySet()) {
            List<String> values = excelData.get(key);
            System.out.println("Key: " + key + ", Values: " + values);
        }
    }
}
